var featureRequest,requestBody;const container=document.getElementById("popup"),content=document.getElementById("popup-content"),closer=document.getElementById("popup-closer");var featureprops=[],vectorSource=new ol.source.Vector,vector=new ol.layer.Vector({source:vectorSource,style:new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(0, 0, 255, 1.0)",width:2}),fill:new ol.style.Fill({color:"rgba(0,0,255,0.5)"})})}),projection=new ol.proj.Projection({code:"EPSG:3857",units:"m",axisOrientation:"neu"});const overlay=new ol.Overlay({element:container,autoPan:!0,autoPanAnimation:{duration:250}});var view=new ol.View({center:[4098004.08,-142987.72],maxZoom:30,zoom:18,projection:projection}),raster=new ol.layer.Tile({source:new ol.source.OSM}),map=new ol.Map({layers:[raster],target:document.getElementById("map"),view:view,overlays:[overlay]}),mousePositionControl=new ol.control.MousePosition({className:"custom-mouse-position",target:document.getElementById("location"),coordinateFormat:ol.coordinate.createStringXY(5),undefinedHTML:"&nbsp;"});closer.onclick=function(){return overlay.setPosition(undefined),closer.blur(),!1};map.on("pointermove",function(n){if(!n.dragging){var t=map.getEventPixel(n.originalEvent),i=map.forEachLayerAtPixel(t,function(){return!0});map.getTargetElement().style.cursor=i?"pointer":""}});featureRequest=(new ol.format.WFS).writeGetFeature({srsName:"EPSG:3857",featureNS:"http://www.intergraph.com/geomedia/gml",featurePrefix:"gmgml",featureTypes:["Parcels"],outputFormat:"application/vnd.geo+json",filter:ol.format.filter.equalTo("Id",routeId)});requestBody=(new XMLSerializer).serializeToString(featureRequest);fetch("https://demo.osl.co.ke:7575/LIMSParcels/service.svc/post",{method:"POST",body:requestBody,headers:new Headers({"Content-Type":"application/xml"})}).then(function(n){var t=n.headers.get("content-type");if(console.log(t),t&&t.includes("application/vnd.geo+json"))return n.json();throw new TypeError("Oops, we haven't got JSON!");}).then(function(n){var t=(new ol.format.GeoJSON).readFeatures(n),i=t[0].getProperties();featureprops.push(i);vectorSource.addFeatures(t);map.getView().fit(vectorSource.getExtent())});map.on("singleclick",function(n){var r=n.coordinate,t,i;console.log(n.features);t="";vectorSource?(i=featureprops[0],t="<h4>"+i.Parcel_Num+"<\/h4>",t+="<p>Lon/Lat: "+r+"<\/p>",t+="<p>Beacons: "+i.Boundary+"<\/p>",t+="<p>Parcel Number: "+i.Parcel_Num+"<\/p>",t+="<p>Owner Name: "+i.Parcel_Own+"<\/p>",t+="<p>Area: "+i.Area2+" Acres<\/p>"):t="<p>No Parcel here<\/p>";console.log(i);content.innerHTML=t;overlay.setPosition(r)});var throbberCounter=0,increaseThrobberCounter=function(){document.getElementById("throbber").style.display="block";++throbberCounter},decreaseThrobberCounter=function(){--throbberCounter;throbberCounter<=0&&(throbberCounter=0,document.getElementById("throbber").style.display="none")},onChangeVisible=function(n){n.oldValue&&this.throbberVisible?(decreaseThrobberCounter(),this.throbberVisible=!1):n.oldValue||this.throbberVisible||(increaseThrobberCounter(),this.throbberVisible=!0)},onRender=function(){this.throbberVisible&&(decreaseThrobberCounter(),this.throbberVisible=!1)};vector.on("change:visible",onChangeVisible);vector.on("render",onRender);map.addLayer(vector);