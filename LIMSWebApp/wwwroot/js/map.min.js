$(function(){var e,o;const h=document.getElementById("popup"),c=document.getElementById("popup-content"),b=document.getElementById("popup-closer");var f=[],t=new ol.source.Vector,r=new ol.layer.Vector({source:t,style:new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(0, 0, 255, 1.0)",width:2}),fill:new ol.style.Fill({color:"rgba(0,0,255,0.5)"})})}),l=new ol.proj.Projection({code:"EPSG:3857",units:"m",axisOrientation:"neu"});const u=new ol.Overlay({element:h,autoPan:!0,autoPanAnimation:{duration:250}});var a=new ol.View({center:[4098004.08,-142987.72],maxZoom:30,zoom:18,projection:l}),v=new ol.layer.Tile({source:new ol.source.OSM}),n=new ol.Map({layers:[v],target:document.getElementById("map"),view:a,overlays:[u]}),k=new ol.control.MousePosition({className:"custom-mouse-position",target:document.getElementById("location"),coordinateFormat:ol.coordinate.createStringXY(5),undefinedHTML:"&nbsp;"});document.getElementById("popup-closer").onclick=function(){return u.setPosition(undefined),document.getElementById("popup-closer").blur(),!1};n.on("pointermove",function(t){if(!t.dragging){var i=n.getEventPixel(t.originalEvent),r=n.forEachLayerAtPixel(i,function(){return!0});n.getTargetElement().style.cursor=r?"pointer":""}});e=(new ol.format.WFS).writeGetFeature({srsName:"EPSG:3857",featureNS:"http://www.intergraph.com/geomedia/gml",featurePrefix:"gmgml",featureTypes:["Parcels"],outputFormat:"application/vnd.geo+json",filter:ol.format.filter.equalTo("Id",routeId)});o=(new XMLSerializer).serializeToString(e);fetch("https://demo.osl.co.ke:7575/LIMSParcels/service.svc/post",{method:"POST",mode:"cors",credentials:"same-origin",body:o,headers:new Headers({"Content-Type":"application/xml","Access-Control-Allow-Credentials":!0,"Access-Control-Allow-Origin":"*"})}).then(function(n){var t=n.headers.get("content-type");if(console.log(t),t&&t.includes("application/vnd.geo+json"))return n.json();throw new TypeError("Oops, we haven't got JSON!");}).then(function(i){var r=(new ol.format.GeoJSON).readFeatures(i),u=r[0].getProperties();f.push(u);t.addFeatures(r);n.getView().fit(t.getExtent())});n.on("singleclick",function(n){var e=n.coordinate,i,r;console.log(n.features);i="";t?(r=f[0],i="<h4>"+r.Parcel_Num+"<\/h4>",i+="<p>Lon/Lat: "+e+"<\/p>",i+="<p>Beacons: "+r.Boundary+"<\/p>",i+="<p>Parcel Number: "+r.Parcel_Num+"<\/p>",i+="<p>Owner Name: "+r.Parcel_Own+"<\/p>",i+="<p>Area: "+r.Area2+" Acres<\/p>"):i="<p>No Parcel here<\/p>";console.log(r);c.innerHTML=i;u.setPosition(e)});var i=0,y=function(){document.getElementById("throbber").style.display="block";++i},s=function(){--i;i<=0&&(i=0,document.getElementById("throbber").style.display="none")},p=function(n){n.oldValue&&this.throbberVisible?(s(),this.throbberVisible=!1):n.oldValue||this.throbberVisible||(y(),this.throbberVisible=!0)},w=function(){this.throbberVisible&&(s(),this.throbberVisible=!1)};r.on("change:visible",p);r.on("render",w);n.addLayer(r)});